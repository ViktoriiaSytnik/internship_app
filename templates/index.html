<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Case Studies</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/handsontable/10.0.0/handsontable.full.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/handsontable/10.0.0/handsontable.full.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            background-color: #121212;
            color: #f5f5f5;
            font-family: 'Montserrat', sans-serif;
            margin: 0;
            padding: 20px;
            transition: background-color 0.3s ease;
        }
        .btn {
            background-color: #6200ea;
            color: white;
            padding: 15px 30px;
            font-size: 18px;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 10px;
        }
        .btn:hover {
            background-color: #3700b3;
        }
        .file-upload {
            margin: 20px;
        }
        .container {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 80vh;
        }
        canvas {
            width: 80%;
            height: 300px;
        }
        #example1 {
            margin: 30px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div>
            <button class="btn">Case Study 1</button>
            <button class="btn">Case Study 2</button>
            <button class="btn">Case Study 3</button>
        </div>
    </div>

    <div class="file-upload">
        <h2>Upload Your Excel File</h2>
        <form action="/upload" method="POST" enctype="multipart/form-data">
            <input type="file" name="file" accept=".xlsx,.xls,.csv" required>
            <button class="btn" type="submit">Upload</button>
        </form>
    </div>

    <div id="example1"></div>
    <canvas id="myChart"></canvas>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.1/xlsx.full.min.js"></script>
    <script>
        // Initialize Handsontable with default data
        var data = [
            ["", "Tesla", "Nissan", "BMW"],
            ["2018", 10, 11, 12],
            ["2019", 14, 13, 15],
            ["2020", 18, 17, 20]
        ];

        var container = document.getElementById('example1');
        var hot = new Handsontable(container, {
            data: data,
            colHeaders: true,
            rowHeaders: true,
            contextMenu: true,
            filters: true,
            dropdownMenu: true
        });

        // Chart.js for data visualization
        var ctx = document.getElementById('myChart').getContext('2d');
        var myChart = new Chart(ctx, {
            type: 'bar',
            data: {
                labels: ['2018', '2019', '2020'],
                datasets: [{
                    label: 'Car Sales',
                    data: [10, 14, 18],
                    backgroundColor: ['rgba(75, 192, 192, 0.2)', 'rgba(153, 102, 255, 0.2)', 'rgba(255, 159, 64, 0.2)'],
                    borderColor: ['rgba(75, 192, 192, 1)', 'rgba(153, 102, 255, 1)', 'rgba(255, 159, 64, 1)'],
                    borderWidth: 1
                }]
            },
            options: {
                scales: {
                    y: { beginAtZero: true }
                }
            }
        });

        // Update chart with Handsontable data
        hot.addHook('afterChange', function(changes, source) {
            var updatedData = hot.getDataAtRow(1);
            myChart.data.datasets[0].data = updatedData.slice(1);
            myChart.update();
        });

        // File upload functionality
        function loadFile(event) {
            var file = event.target.files[0];
            var reader = new FileReader();
            reader.onload = function(e) {
                var data = e.target.result;
                var workbook = XLSX.read(data, { type: 'binary' });
                var sheet = workbook.Sheets[workbook.SheetNames[0]];
                var excelData = XLSX.utils.sheet_to_json(sheet, { header: 1 });
                hot.loadData(excelData);  // Load data into Handsontable
            };
            reader.readAsBinaryString(file);
        }
    </script>
</body>
</html>
